{"ast":null,"code":"// src/ManageUsers.js\n// ✅ Lab 4 Upgrade: Use backend APIs for user management\nimport React,{useEffect,useState}from'react';import'./style.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE='http://127.0.0.1:5000';// ✅ Use 127.0.0.1 to avoid CORS issues\nconst ManageUsers=()=>{const[users,setUsers]=useState([]);const[currentUser,setCurrentUser]=useState(null);const[error,setError]=useState('');// Load current user from localStorage\nuseEffect(()=>{const savedUser=JSON.parse(localStorage.getItem('currentUser'))||null;setCurrentUser(savedUser);},[]);// Fetch all users from backend\nconst fetchUsers=()=>{fetch(\"\".concat(API_BASE,\"/users\")).then(res=>{if(!res.ok)throw new Error('Failed to fetch users');return res.json();}).then(data=>setUsers(data.data)).catch(err=>setError(err.message));};useEffect(()=>{fetchUsers();},[]);// Delete user (except admin)\nconst handleDeleteUser=id=>{const userToDelete=users.find(user=>user.id===id);if(!userToDelete)return;if(userToDelete.username==='admin'){alert('Cannot delete admin user.');return;}fetch(\"\".concat(API_BASE,\"/users/\").concat(id),{method:'DELETE'}).then(res=>{if(!res.ok)throw new Error('Failed to delete user.');fetchUsers();if(currentUser&&currentUser.id===id){localStorage.removeItem('currentUser');setCurrentUser(null);}}).catch(err=>alert(err.message));};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"dashboard-title\",children:\"Manage Users\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsxs(\"p\",{style:{fontWeight:'bold',color:'#333'},children:[\"Currently logged in as:\",' ',/*#__PURE__*/_jsx(\"span\",{style:{color:'#007bff'},children:currentUser?\"\".concat(currentUser.username,\" (\").concat(currentUser.isAdmin?'Admin':'User',\")\"):'None'})]}),users.length===0?/*#__PURE__*/_jsx(\"p\",{style:{color:'#888'},children:\"No users found.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"user-list\",children:users.map(user=>/*#__PURE__*/_jsxs(\"li\",{className:\"user-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"user-role-label\",children:user.username==='admin'?'Admin':'User'}),user.username!=='admin'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteUser(user.id),className:\"delete-button\",children:\"Delete\"})]},user.id))})]});};export default ManageUsers;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","API_BASE","ManageUsers","users","setUsers","currentUser","setCurrentUser","error","setError","savedUser","JSON","parse","localStorage","getItem","fetchUsers","fetch","concat","then","res","ok","Error","json","data","catch","err","message","handleDeleteUser","id","userToDelete","find","user","username","alert","method","removeItem","className","children","style","color","fontWeight","isAdmin","length","map","onClick"],"sources":["/Users/zhanghan/Desktop/Program lab/used-car-marketplace/frontend/src/ManageUsers.js"],"sourcesContent":["// src/ManageUsers.js\n// ✅ Lab 4 Upgrade: Use backend APIs for user management\n\nimport React, { useEffect, useState } from 'react';\nimport './style.css';\n\nconst API_BASE = 'http://127.0.0.1:5000';  // ✅ Use 127.0.0.1 to avoid CORS issues\n\nconst ManageUsers = () => {\n  const [users, setUsers] = useState([]);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [error, setError] = useState('');\n\n  // Load current user from localStorage\n  useEffect(() => {\n    const savedUser = JSON.parse(localStorage.getItem('currentUser')) || null;\n    setCurrentUser(savedUser);\n  }, []);\n\n  // Fetch all users from backend\n  const fetchUsers = () => {\n    fetch(`${API_BASE}/users`)\n      .then((res) => {\n        if (!res.ok) throw new Error('Failed to fetch users');\n        return res.json();\n      })\n      .then((data) => setUsers(data.data))\n      .catch((err) => setError(err.message));\n  };\n\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n\n  // Delete user (except admin)\n  const handleDeleteUser = (id) => {\n    const userToDelete = users.find((user) => user.id === id);\n    if (!userToDelete) return;\n\n    if (userToDelete.username === 'admin') {\n      alert('Cannot delete admin user.');\n      return;\n    }\n\n    fetch(`${API_BASE}/users/${id}`, {\n      method: 'DELETE',\n    })\n      .then((res) => {\n        if (!res.ok) throw new Error('Failed to delete user.');\n        fetchUsers();\n        if (currentUser && currentUser.id === id) {\n          localStorage.removeItem('currentUser');\n          setCurrentUser(null);\n        }\n      })\n      .catch((err) => alert(err.message));\n  };\n\n  return (\n    <div className=\"container\">\n      <h1 className=\"dashboard-title\">Manage Users</h1>\n\n      {error && <p style={{ color: 'red' }}>{error}</p>}\n\n      <p style={{ fontWeight: 'bold', color: '#333' }}>\n        Currently logged in as:{' '}\n        <span style={{ color: '#007bff' }}>\n          {currentUser\n            ? `${currentUser.username} (${currentUser.isAdmin ? 'Admin' : 'User'})`\n            : 'None'}\n        </span>\n      </p>\n\n      {/* User List */}\n      {users.length === 0 ? (\n        <p style={{ color: '#888' }}>No users found.</p>\n      ) : (\n        <ul className=\"user-list\">\n          {users.map((user) => (\n            <li key={user.id} className=\"user-row\">\n              <span className=\"user-name\">{user.username}</span>\n              <span className=\"user-role-label\">\n                {user.username === 'admin' ? 'Admin' : 'User'}\n              </span>\n              {user.username !== 'admin' && (\n                <button\n                  onClick={() => handleDeleteUser(user.id)}\n                  className=\"delete-button\"\n                >\n                  Delete\n                </button>\n              )}\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nexport default ManageUsers;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}